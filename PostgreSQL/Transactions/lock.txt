

		Блокировки

				Блокировки могут быть востребованы при проектировании транзакций с уровнм Read Committed?
				когда требуется более детальное управление параллельным выполнением тразакций.

				PostgreSQL предоставляет несколько видов блокировок, но будут рассмотрены 2
				
				Рассмотрим 2 вида блокроврок:

						1) Блокировка отдельных строк
						2) Блокировка на уровне таблиц


				Блокировка отдельных строк (FOR UPDATE).

						(Откроем 2 терминала для параллельного обращения к БД, чтоы продемонстрировать работу)

								Окно №1:

										SELECT * FROM aircraft_tmp 
										WHERE model ~ '^Air'
										FOR UPDATE;

								Окно №2:

										SELECT * FROM aircrafts_tmp
										WHERE model ~ '^Air'
										FOR UPDATE;


								(Далее следует обновить строку из 1го терминала и завершить транзакцию на нем, чтобы 2 выполнлась)

								Окно №1:

										UPDATE aircraft_tmp
											 SET range = 5800
										 WHERE aircraft_code = '320';

								(После этого на 2 терминале будет выведена выборка !НО! уже с новыми данными, добавленными из 1 окна )

								Далее следует завершить и 2ю транзакцию.


				Блокировка на уровне талиц (LOCK TABLE)

						(В этом примере также слеудет использовать 2 терминала)

								Окно №1:

										LOCK TABLE aircrafts_tmp IN ACCESS EXCLUSIVE MODE;

								Окно №2:

										SELECT * FROM aircraft_tmp 
										WHERE model ~ '^Air'
										FOR UPDATE;

								(Вторая команда будет задержена)